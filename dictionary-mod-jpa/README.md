# How to generate the project with `mvn` command
https://quarkus.io/guides/getting-started

# Example request
`curl "http://localhost:8080/lexical-items/curate;language=en-US/explanations?language=zh-CN"`


# Quarkus Cheatsheet: Practical lessons learnt
## Quarkus dependency search engine
https://code.quarkus.io/

## From https://github.com/rxue/dictionary/issues/172
`@Embedded` class is not supported to be in an abstract `@Entity` class. This kinda just obey the "composition over inheritance rule"

## From https://github.com/rxue/dictionary/issues/174 on 20250529
When using `quarkus-resteasy-jsonb` to make REST API endpoint, the attribute annotated with `@Embedded` inside a *JPA entity* will not be visible in the implemented REST API endpoint response JSON. This is a bit different from that when using `resteasy` of *WildFly* to implement the REST API. In order to make the `@Embedded` attribute visible in the response JSON, add *getter* and *setter* to that `@Embedded` field. Moreover, the `@Embedded` annotation is not compulsory, i.e. it can be removed

## 20250604 
### Database schema is not initialized by Hibernate in IT tests by means of `@QuarkusIntegrationTest` but `@QuarkusTest`
### In Quarkus project generated by means of Quarkus project starter, the `skipITs` is set to `true` by default
### When running all the tests with `mvn clean verify`. As to those IT tests using `@QuarkusTests` to start database generate with Hibernate, database schema is initialized by Hibernate only once for all the IT test classes

# IntelliJ learning tutorial with Linux OS
## Keyboard shortcut
### "Alt + Insert" to *create a New* class/package etc.

# Daybook
## 20250712
### Create a Web App (a REST API)
#### Pre-requisite: `az appservice plan create`
```
az appservice plan create \
  --name dictionary-service-plan \
  --resource-group dictionary-rest-api_group \ 
  --subscription $subscriptionId \
  --sku F1 \
  --is-linux
```
Knowledge resource: https://www.youtube.com/watch?v=kIHC94k1Zb4
#### `az webapp create`
```
az webapp create \
  --name dictionary-rest-api \
  --plan dictionary-service-plan \
  --resource-group dictionary-rest-api_group \
  --deployment-container-image-name ruixue/dictionary-rest-api:1.0
```

Note that if an `webapp` is `delete`, its App Service Plan is deleted cascadely

## 20250715
### `az postgresql`
#### Create a Postgresql Flexible Server
```
az postgres flexible-server create \
  --name dictionary-db \
  --resource-group $resourceGroupName \
  --location $locationName \
  --admin-user $username \
  --admin-password $password \
  --sku-name Standard_B1ms \
  --tier Burstable \
  --storage-size 32 \
  --version 15 \
  --public-access 0.0.0.0-255.255.255.255
```
Relevant knowledge resources
* on free trial: https://learn.microsoft.com/en-us/azure/postgresql/flexible-server/how-to-deploy-on-azure-free-account
* CapEx: https://www.youtube.com/watch?v=WiwV9wb0GMo
* Flexible Server for PostgreSQL on Azure: https://www.youtube.com/watch?v=damXLEH0VTQ
#### After the Postgresql flexible server is created, it is in *Ready* state, then find its connection string
```
az postgres flexible-server show-connection-string \
  --server-name dictionary-db \
  --admin-user admin_rui
```
The output looks like
```
{
  "connectionStrings": {
    "ado.net": "Server=dictionary-db.postgres.database.azure.com;Database={database};Port=5432;User Id=admin_rui;Password={password};Ssl Mode=Require;",
    "jdbc": "jdbc:postgresql://dictionary-db.postgres.database.azure.com:5432/{database}?user=admin_rui&password={password}&sslmode=require",
    "jdbc Spring": "spring.datasource.url=jdbc:postgresql://dictionary-db.postgres.database.azure.com:5432/{database}  spring.datasource.username=admin_rui  spring.datasource.password={password}",
    "node.js": "var conn= new Client({host:'dictionary-db.postgres.database.azure.com', user:'admin_rui', password:'{password}', database:'{database}', port:5432, ssl:{ca:fs.readFileSync(\"{ca-cert filename}\")}});",
    "php": "pg_connect(\"host=dictionary-db.postgres.database.azure.com port=5432 dbname={database} user=admin_rui password={password}\");",
    "psql_cmd": "postgresql://admin_rui:{password}@dictionary-db.postgres.database.azure.com/{database}?sslmode=require",
    "python": "cnx = psycopg2.connect(user='admin_rui', password='{password}', host='dictionary-db.postgres.database.azure.com', port=5432, database='{database}')",
    "ruby": "connection = PG::Connection.new(user => \"admin_rui\", password => \"{password}\", database => \"{database}\", host => \"dictionary-db.postgres.database.azure.com\", port => '5432')"
  }
}
```

When connecting to the database with `psql` command, the placeholder `{password}` can be ignored and then the password is asked interactively
##### How to install PostgreSQL client on MacOS with `brew`
`brew install libpq` and then `brew link --force libpq`

#### Configure database connection settings with `az webapp config appsettings set` command
```
az webapp config appsettings set \
  --resource-group myResourceGroup \
  --name myWebApp \
  --settings QUARKUS_DATASOURCE_USERNAME=myuser \
             QUARKUS_DATASOURCE_PASSWORD=mypass \
             QUARKUS_DATASOURCE_JDBC_URL=jdbc:postgresql://...
```

